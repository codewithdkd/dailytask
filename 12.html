 <!-- ===================================================== -->
<!-- MOBILE PERFORMANCE TRACKER (ADVANCED CALORIE SYSTEM) -->
<!-- Owner: Deepak Kumar Deep -->
<!-- ===================================================== -->

<!DOCTYPE html>
<html lang="en">
<header>Daily Performance Tracker</header>

<div class="container">

<div class="card">
<h3>Today's Summary</h3>
<div class="summary-grid">
<div class="summary-box"><strong id="sumBurn">0</strong>Total Burn</div>
<div class="summary-box"><strong id="sumTaken">0</strong>Consumed</div>
<div class="summary-box"><strong id="sumDeficit">0</strong>Deficit</div>
<div class="summary-box"><strong id="sumSleep">0</strong>Sleep (hrs)</div>
</div>
</div>

 <div class="card">
<h3>This Month Summary</h3>
<div class="summary-grid">
  <div class="summary-box"><strong id="mStudy">0</strong>Study (hrs)</div>
  <div class="summary-box"><strong id="mRun">0</strong>Run (km)</div>
  <div class="summary-box"><strong id="mBurn">0</strong>Burned</div>
  <div class="summary-box"><strong id="mTaken">0</strong>Taken</div>
  <div class="summary-box" style="grid-column:span 2">
    <strong id="mDeficit">0</strong>Total Deficit
  </div>
</div>
</div>

="date" readonly>
</div>

<div class="form-group">
<label>Study Hours</label>
<input type="number" step="0.1" id="study">
</div>

<div class="form-group">
<label>Sleep Time</label>
<input type="time" id="sleepTime">
</div>

<div class="form-group">
<label>Wake Time</label>
<input type="time" id="wakeTime">
</div>

<div class="form-group">
<label>Running Distance (km)</label>
<input type="number" step="0.1" id="running">
</div>

<div class="form-group">
<label>Exercise Calories Burned</label>
<input type="number" id="exerciseBurn" placeholder="Only workout calories">
<div class="small-note">Your body baseline burn (BMR) is auto-added: 1700 kcal</div>
</div>

<div class="form-group">
<label>Calories Consumed</label>
<input type="number" id="taken">
</div>

<div class="form-group">
<label>Water Intake (L)</label>
<input type="number" step="0.1" id="water">
</div>

<div class="form-group">
<label>Weight (kg)</label>
<input type="number" step="0.1" id="weight">
</div>

<div class="form-group">
<label>Notes</label>
<textarea id="notes"></textarea>
</div>

<button onclick="submitData()">Save Today's Entry</button>
</div>

</div>

<script>

const scriptURL="https://script.google.com/macros/s/AKfycbwzoSmcfOnz0meDVEtyV0fJvNVQlnJOqhNjrN34fNp_uMlDJ6Wf2sYNwAS7VKudSSoC/exec";
const BASE_BMR=1700; // default body burn

const today=new Date().toISOString().split('T')[0];
document.getElementById("date").value=today;

function calculateSleep(s,w){
if(!s||!w) return 0;
let a=new Date(`1970-01-01T${s}:00`);
let b=new Date(`1970-01-01T${w}:00`);
let diff=(b-a)/(1000*60*60);
if(diff<0) diff+=24;
return diff.toFixed(2);
}

function submitData(){

const sleep=calculateSleep(
document.getElementById("sleepTime").value,
document.getElementById("wakeTime").value);

const exerciseBurn=Number(document.getElementById("exerciseBurn").value||0);
const totalBurn=BASE_BMR + exerciseBurn;
const taken=Number(document.getElementById("taken").value||0);
const deficit= totalBurn - taken; // ✅ Correct Formula

const data={
date:today,
study:Number(document.getElementById("study").value||0),
sleepDuration:Number(sleep),
running:Number(document.getElementById("running").value||0),
caloriesBurned:totalBurn,
exerciseBurn:exerciseBurn,
caloriesTaken:taken,
deficit:deficit,
water:Number(document.getElementById("water").value||0),
weight:Number(document.getElementById("weight").value||0),
notes:document.getElementById("notes").value
};

fetch(scriptURL,{method:"POST",body:JSON.stringify(data)})
.then(res=>res.text())
.then(()=>{
updateSummary(totalBurn,taken,deficit,sleep);
alert("Saved Successfully ✅");
});
}

function updateSummary(burn,taken,deficit,sleep){
document.getElementById("sumBurn").innerText=burn;
document.getElementById("sumTaken").innerText=taken;
document.getElementById("sumDeficit").innerText=deficit;
document.getElementById("sumSleep").innerText=sleep;
}

</script>

 <script>
function loadMonthlySummary(){
  const month = new Date().toISOString().slice(0,7); // YYYY-MM

  fetch(scriptURL + "?month=" + month)
    .then(res => res.json())
    .then(data => {
      document.getElementById("mStudy").innerText = data.study || 0;
      document.getElementById("mRun").innerText = data.running || 0;
      document.getElementById("mBurn").innerText = data.burn || 0;
      document.getElementById("mTaken").innerText = data.taken || 0;
      document.getElementById("mDeficit").innerText = data.deficit || 0;
    })
    .catch(err => console.log("Monthly summary error", err));
}

loadMonthlySummary();
</script>


</body>
</html>
